<!DOCTYPE html>
<html lang="pt-BR" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nova Locação</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .borda-container {
            border: 1px solid #dee2e6;
            border-radius: 0.25rem;
            padding: 1.5rem;
            margin-bottom: 1rem;
        }
        .titulo {
            text-align: center;
            margin-bottom: 1.5rem;
        }
        .table-container {
            max-height: 400px;
            overflow-y: auto;
        }
        .hidden {
            display: none;
        } /* Tenho q botar isso em um arquivo separado */
    </style>
</head>
<body>

<nav class="navbar navbar-expand-lg custom-header">
    <div class="container-fluid">
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavDarkDropdown"
                aria-controls="navbarNavDarkDropdown" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarNavDarkDropdown">
            <ul class="navbar-nav">
                <li class="nav-item dropdown">
                    <button class="btn dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">Cadastro
                    </button>
                    <ul class="dropdown-menu">
                        <li><a class="dropdown-item" href="#">Pessoa</a></li>
                        <li><a class="dropdown-item" href="#">Endereço</a></li>
                        <li><a class="dropdown-item" href="#">Curso</a></li>
                    </ul>
                </li>

                <li class="nav-item dropdown">
                    <button class="btn dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">Curso</button>
                    <ul class="dropdown-menu">
                        <li><a class="dropdown-item" href="#">Matricular Estudante</a></li>
                        <li><a class="dropdown-item" href="#">Professor da Oferta</a></li>
                    </ul>
                </li>

                <li class="nav-item dropdown">
                    <button class="btn dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">Relatórios
                    </button>
                    <ul class="dropdown-menu">
                        <li><a class="dropdown-item" href="#">Matriculados por curso</a></li>
                        <li><a class="dropdown-item" href="#">Cursos do estudante</a></li>
                    </ul>
                </li>
            </ul>
        </div>

        <ul class="navbar-nav ms-auto">
            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">
                    <span class="navbar-text" th:if="${username != null}">
                        Olá, <span th:text="${username}"></span>!
                    </span>
                </button>
                <ul class="dropdown-menu custom-dropdown">
                    <li>
                        <form id="logoutForm" action="/logout" method="POST">
                            <button class="dropdown-item" type="submit">Logout</button>
                        </form>
                    </li>
                </ul>
            </li>
        </ul>
    </div>
</nav>

<div class="container mt-5">
    <section class="borda-container">
        <h3 class="titulo">Nova Locação</h3>

        <div th:if="${Sucesso}" class="alert alert-success" role="alert" th:text="${Sucesso}"></div>
        <div th:if="${Erro}" class="alert alert-danger" role="alert" th:text="${Erro}"></div>

        <form th:action="@{/locacao/salvarLocacao}" th:object="${locacaoDTO}" method="post">
            <input type="hidden" th:field="*{id}" value="0">
            <div class="row mb-3">
                <div class="col-md-6">
                    <label class="form-label" for="nome">Nome do Cliente:</label>
                    <input type="text" class="form-control" id="nome" th:field="*{nome}" required>
                </div>
                <div class="col-md-6">
                    <label class="form-label" for="cpf">CPF:</label>
                    <input type="text" class="form-control" id="cpf" th:field="*{cpf}" placeholder="000.000.000-00"
                           required>
                </div>
            </div>

            <div class="row mb-3">
                <div class="col-md-6">
                    <label class="form-label" for="email">E-mail:</label>
                    <input type="email" class="form-control" id="email" th:field="*{email}" required>
                </div>
                <div class="col-md-6">
                    <label class="form-label" for="telefone">Telefone:</label>
                    <input type="tel" class="form-control" id="telefone" th:field="*{telefone}"
                           placeholder="(00) 00000-0000" required>
                </div>
            </div>

            <div class="row mb-3">
                <div class="col-md-6">
                    <label class="form-label" for="dataLocacao">Data de Locação:</label>
                    <input type="date" class="form-control" id="dataLocacao" th:field="*{dataLocacao}" required>
                </div>
                <div class="col-md-6">
                    <label class="form-label" for="dataDevolucao">Data de Devolução Prevista:</label>
                    <input type="date" class="form-control" id="dataDevolucao" th:field="*{dataDevolucao}" required>
                </div>
            </div>

            <div class="row mb-3">
                <div class="col-12">
                    <label class="form-label">Filmes Selecionados (máx. 3):</label>
                    <table class="table table-bordered" id="tabelaFilmesSelecionados">
                        <thead>
                        <tr>
                            <th>Título do Filme</th>
                            <th>ID Exemplar</th>
                            <th>Ação</th>
                        </tr>
                        </thead>
                        <tbody>
                        </tbody>
                    </table>
                    <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#modalFilmes">
                        Selecionar Filme
                    </button>
                </div>
            </div>

            <div class="row mt-4">
                <div class="col-12 text-center">
                    <button type="submit" class="btn btn-success me-2">Salvar Locação</button>
                    <a th:href="@{/locacao/buscar}" class="btn btn-danger">Cancelar</a>
                </div>
            </div>
        </form>
    </section>
</div>

<div class="modal fade" id="modalFilmes" tabindex="-1" aria-labelledby="modalFilmesLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="modalFilmesLabel">Selecionar Filme</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fechar"></button>
            </div>
            <div class="modal-body">

                <div id="tabelaFilmesSection">
                    <div class="table-container">
                        <table class="table table-bordered">
                            <thead>
                            <tr>
                                <th>ID</th>
                                <th>Título</th>
                                <th>Exemplares Disponíveis</th>
                                <th>Ação</th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr th:each="filme : ${filmes}">
                                <td th:text="${filme[0]}"></td>
                                <td th:text="${filme[1]}"></td>
                                <td th:text="${filme[2]}"></td>
                                <td>
                                    <button type="button" class="btn btn-success btn-sm"
                                            th:attr="onclick=|abrirExemplares('${filme[0]}', '${filme[1]}')|"
                                            aria-label="Selecionar filme">
                                        Selecionar
                                    </button>
                                </td>
                            </tr>
                            <tr th:if="${filmes.isEmpty()}">
                                <td colspan="4" class="text-center">Nenhum filme com exemplares cadastrado</td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <div id="tabelaExemplaresSection" class="hidden">
                    <h5 id="tituloFilmeSelecionado"></h5>
                    <button type="button" class="btn btn-secondary btn-sm mb-2" onclick="voltarParaFilmes()">Voltar
                    </button>
                    <div class="table-container">
                        <table class="table table-bordered">
                            <thead>
                            <tr>
                                <th>ID Exemplar</th>
                                <th>Data Cadastro</th>
                                <th>Ação</th>
                            </tr>
                            </thead>
                            <tbody id="tabelaExemplaresBody"></tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- Teste de QR
<div class="qrcode-container">
    <img src="data:image/png;base64,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" alt="QR Code Gerado">
</div>-->


<script src="https://unpkg.com/imask"></script>
<script>
    const locacaoState = { filmesSelecionados: [], currentFilme: {} };

    const $ = (selector) => document.querySelector(selector);
    const $$ = (selector) => document.querySelectorAll(selector);

    const toggleSections = (showFilmes) => {
        $("#tabelaFilmesSection").style.display = showFilmes ? "block" : "none";
        $("#tabelaExemplaresSection").style.display = showFilmes ? "none" : "block";
        $("#tituloFilmeSelecionado").textContent = showFilmes ? "" : `Exemplares de: ${locacaoState.currentFilme.titulo}`;
    };

    async function abrirExemplares(id, titulo) {
        locacaoState.currentFilme = { id, titulo };
        toggleSections(false);

        const tbody = $("#tabelaExemplaresBody");
        tbody.innerHTML = "";
        try {
            const res = await fetch(`/locacao/exemplaresPorTitulo?titulo=${encodeURIComponent(titulo)}`);
            const exemplares = await res.json();

            tbody.innerHTML = exemplares.length
                ? exemplares.map(e => `
                    <tr>
                        <td>${e.id}</td>
                        <td>${formatDate(e.dataCadastro)}</td>
                        <td>
                            <button class="btn btn-success btn-sm" onclick="selecionarExemplar('${e.id}')">Selecionar</button>
                        </td>
                    </tr>`).join("")
                : `<tr><td colspan="3" class="text-center">Nenhum exemplar disponível</td></tr>`;
        } catch(error) {
             console.error("Erro ao carregar exemplares:", error);
            tbody.innerHTML = `<tr><td colspan="3" class="text-center text-danger">Erro ao carregar exemplares.</td></tr>`;
        }
    }

    const formatDate = (d) => {
        if (!d) return "N/A";
        const date = new Date(d);

        if (isNaN(date.getTime())) {
            return "Data inválida";
        }
        return date.toLocaleDateString("pt-BR");
    };

    function selecionarExemplar(idExemplar) {
        const { titulo } = locacaoState.currentFilme;

        const idExemplarNum = parseInt(idExemplar, 10);

        if (locacaoState.filmesSelecionados.length >= 3) {
            alert("Você só pode selecionar até 3 exemplares.");
            return;
        }

        const jaSelecionado = locacaoState.filmesSelecionados.some(f => parseInt(f.idExemplar, 10) === idExemplarNum);
        if (jaSelecionado) {
            alert("Este exemplar já foi selecionado.");
            return;
        }

        locacaoState.filmesSelecionados.push({ titulo, idExemplar });
        atualizarTabelaFilmes();

        const modalElement = $("#modalFilmes");
        const modal = bootstrap.Modal.getInstance(modalElement);
        if (modal) {
            modal.hide();
        } else {

            $(modalElement).classList.remove('show');
            $(modalElement).style.display = 'none';
            $(modalElement).setAttribute('aria-hidden', 'true');
            $(modalElement).setAttribute('aria-modal', 'false');
            const body = document.body;
            body.classList.remove('modal-open');
            body.style.overflow = '';
            body.style.paddingRight = '';
            const backdrop = document.querySelector('.modal-backdrop');
            if (backdrop) backdrop.remove();
        }
        toggleSections(true);
    }

    const atualizarTabelaFilmes = () => {
        const tbody = $("#tabelaFilmesSelecionados tbody");
        tbody.innerHTML = locacaoState.filmesSelecionados.map((f, i) => `
            <tr>
                <td>${f.titulo}</td>
                <td>${f.idExemplar}</td>
                <td><button type="button" class="btn btn-danger btn-sm" onclick="removerLinha(${i})">Remover</button></td>
            </tr>
            <input type="hidden" name="exemplaresSelecionados" value="${f.idExemplar}">
            `
        ).join("");
    };

    const removerLinha = (index) => {
        locacaoState.filmesSelecionados.splice(index, 1);
        atualizarTabelaFilmes(); // Re-renderiza a tabela e os inputs hidden
    };

    const voltarParaFilmes = () => toggleSections(true);

    document.addEventListener("DOMContentLoaded", () => {

        IMask($("#cpf"), { mask: "000.000.000-00" });
        IMask($("#telefone"), { mask: "(00) 00000-0000" });


        const modalFilmesElement = $("#modalFilmes");
        modalFilmesElement.addEventListener('hidden.bs.modal', function (event) {

            toggleSections(true);

        });
    });
</script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>